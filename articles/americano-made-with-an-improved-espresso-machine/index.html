<!DOCTYPE html><html lang="en"><head><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1"><meta name="viewport" content="width=device-width"><title>Americano, made with an improved Espresso machine. - DocuSign Dev Blog</title><link rel="alternate" href="undefined/feed.xml" type="application/rss+xml" title="Brought to you by the development teams at DocuSign"><link rel="stylesheet" href="/assets/css/bootstrap.min.css"><link rel="stylesheet" href="/assets/css/syntax.css"><link href="//fonts.googleapis.com/css?family=Inconsolata:400,700&amp;subset=latin,latin-ext" rel="stylesheet" type="text/css"><link href="//fonts.googleapis.com/css?family=Lora:400,700,400italic,700italic" rel="stylesheet" type="text/css"><link rel="stylesheet" href="/assets/css/devblog.css"><link rel="icon" href="/favicon.ico"><link rel="shortcut icon" type="image/x-icon" href="/assets/img/favicon/docusigndev-favicon-32.png"><link rel="apple-touch-icon" sizes="114×114" href="/assets/img/favicon/docusigndev-favicon-114.png"><link rel="apple-touch-icon" sizes="72×72" href="/assets/img/favicon/docusigndev-favicon-72.png"><link rel="apple-touch-icon" href="/assets/img/favicon/docusigndev-favicon-57.png"><link rel="apple-touch-icon" sizes="512x512" href="/assets/img/favicon/docusigndev-favicon-512.png"></head><body class="article-detail"><div class="container"><header id="top-header" class="row"><div class="col-sm-12"><h1><a href="/">DocuSign Dev Blog</a></h1><h2>Brought to you by the development teams at DocuSign</h2></div></header><div class="row"><div id="left-col" class="col-sm-3 col-md-2"><nav><ul class="row"><li class="col-sm-12"><a href="/contributors/">Contributors</a></li><li class="col-sm-12"><a href="http://github.com/docusigndev">Code</a></li><li class="col-sm-12"><a href="https://twitter.com/docusigndev">Follow</a></li><li class="col-sm-12"><a href="http://www.docusign.com">DocuSign.com</a></li></ul></nav><section class="row about-author"><div class="col-sm-12"><a href="/contributors/stephen-parish/" class="author-name">Stephen Parish</a></div><div class="col-xs-4 col-sm-12"><div class="author-pic"><a href="/contributors/stephen-parish/"><img alt="Stephen Parish" src="http://www.gravatar.com/avatar/5e00b4770d5669b56f4fcb56a7f50cbb?s=200"></a></div></div><div class="col-xs-6 col-sm-12"><div class="author-blurb">Software Engineer</div><div class="author-twitter">Twitter:
&nbsp;<a href="http://twitter.com/stephenparish">@stephenparish</a></div><div class="author-github">Github:
&nbsp;<a href="http://github.com/stephenparish">stephenparish</a></div></div></section><section class="tags"><ul><li><a href="/topic/android/">android</a></li><li><a href="/topic/espresso/">espresso</a></li><li><a href="/topic/android-test-kit/">android-test-kit</a></li><li><a href="/topic/open-source/">open-source</a></li></ul></section></div><main id="right-col" class="col-sm-8 col-sm-offset-1 col-md-9"><div class="article-meta"><div class="date">17 October 2014</div></div><h1>Americano, made with an improved Espresso machine.</h1><article><section class="content"><p>Today we are publishing <a href="https://github.com/DocuSignDev/americano">Americano</a>, an open source Android library of helpers to build on top of <a href="https://code.google.com/p/android-test-kit">Espresso</a>, an Android <span class="caps">API</span> by Google for writing reliable <span class="caps">UI</span> tests. Along with the release of Americano, we also want to cover the useful improvements we’ve made to <a href="https://github.com/DocuSignDev/android-test-kit">our own fork of&nbsp;Espresso</a>. </p>
<p>The two are meant to be used together, but if need be, Americano can be used completely with the current version of Espresso released by&nbsp;Google.</p>
<h2 id="espresso-faster-running-and-debugging">Espresso: Faster Running and&nbsp;Debugging</h2>
<h3 id="speed">Speed</h3>
<p>When running functional <span class="caps">UI</span> tests, the biggest drain is almost always time. At first we felt an excessive drain with Espresso, especially if any test required a <code>waitFor(time, assert)</code> assertion. We found that if the app moved between root windows at all during the test (e.g. started a new activity, or opened a dialog) the assertion would wait for the full time requested before finding the most present window and performing the&nbsp;assertion.</p>
<p>To fix this, Espresso now maintains multiple root windows and listens for them to be added rather than waiting to update the selected window at specific times. This allows us to follow all view hierarchy changes and assert as soon as the view we are looking for is&nbsp;present.</p>
<h3 id="screenshots">Screenshots</h3>
<p>Possibly the most useful of the improvements, Espresso will now capture screenshots leading up to a test failure and the final screenshot of where an assertion or attempted action failed. This makes debugging the view hierarchy that is printed to the console by Espresso quick and easier to understand. Espresso will dump only the failure screenshots into the <a href="https://github.com/DocuSignDev/android-test-kit#screenshots">test results&nbsp;directory.</a></p>
<h2 id="americano-describing-the-finer-details">Americano: Describing the Finer&nbsp;Details</h2>
<p>With Americano, our goal was to provide a few more useful methods for describing a specific view among a giant group of similar views. For that, we’ve added a few different types of <a href="https://code.google.com/p/android-test-kit/source/browse/espresso/lib/src/main/java/com/google/android/apps/common/testing/ui/espresso/matcher/ViewMatchers.java">View “Matchers”</a> for&nbsp;Espresso.</p>
<h3 id="dimensional-matchers">Dimensional&nbsp;Matchers</h3>
<p>These are meant to help locate a view that should be next, overlapping or under another view. For this, we’ve added the <code>DimensionalMatchers</code> class. The dimensional matchers will find you any view that has the relation requested to your&nbsp;view.</p>
<p>Below, the matcher <code>entirelyAbove</code> is returning all views that are above and not overlapping “Forgot Password?”, and then asserting that “Log In” is one of&nbsp;them.</p>
<pre><code class="lang-java">onView(withText(<span class="string">"Log In"</span>))
    .check(matches(is(entirelyAbove(withText(<span class="string">"Forgot Password?"</span>)))));</code></pre>
<p>Full list of dimensional&nbsp;helpers:</p>
<ul>
<li><code>above</code>, <code>entirelyAbove</code></li>
<li><code>below</code>, <code>entirelyBelow</code></li>
<li><code>leftOf</code>, <code>entirelyLeftOf</code></li>
<li><code>rightOf</code>, <code>entirelyRightOf</code></li>
</ul>
<h3 id="ranking-matchers">Ranking&nbsp;Matchers</h3>
<p>Along with the relational helpers, there is also a class of <code>RankingMatchers</code>. The ranking matchers will find the leftmost, lowest or even widest view by the description&nbsp;given.</p>
<pre><code class="lang-java">onView(lowest(withText(<span class="string">"Log In"</span>)))
    .perform(click());</code></pre>
<p>Full list of ranking&nbsp;matchers:</p>
<ul>
<li><code>mostleft</code></li>
<li><code>mostright</code></li>
<li><code>lowest</code></li>
<li><code>highest</code></li>
<li><code>widest</code></li>
<li><code>skinniest</code></li>
<li><code>tallest</code></li>
<li><code>shortest</code></li>
</ul>
<p>These improvements to Espresso and additions of Americano have helped immensely while creating a robust and reliable test suite for Android. Have a look at <a href="https://github.com/DocuSignDev/americano">Americano</a> and our <a href="https://github.com/DocuSignDev/android-test-kit">Espresso fork</a> to get&nbsp;going.</p>
<p>Be sure to send any virtual high fives to the developers that made this happen: <a href="https://github.com/tophyr">@tophyr</a>, <a href="https://github.com/abeatte">@abeatte</a> and <a href="https://github.com/stephenparish">@stephenparish</a>.</p>
<div class="share-box"><div id="fb-button" data-href="http://engineering.docusign.com/articles/americano-made-with-an-improved-espresso-machine/" data-type="button_count" style="width:auto !important;" class="fb-share-button"></div><div id="fb-root"><script>(function(d, s, id) {
var js, fjs = d.getElementsByTagName(s)[0];
if (d.getElementById(id)) return;
js = d.createElement(s); js.id = id;
js.src = "//connect.facebook.net/en_US/all.js#xfbml=1&appId=221822221222506";
fjs.parentNode.insertBefore(js, fjs);
}(document, 'script', 'facebook-jssdk'));
</script></div><a id="twtr-button" href="https://twitter.com/share" data-url="http://engineering.docusign.com/articles/americano-made-with-an-improved-espresso-machine/" data-via="docusigndev" class="twitter-share-button">Tweet<script>!function(d,s,id){var js,fjs=d.getElementsByTagName(s)[0],p=/^http:/.test(d.location)?'http':'https';if(!d.getElementById(id)){js=d.createElement(s);js.id=id;js.src=p+'://platform.twitter.com/widgets.js';fjs.parentNode.insertBefore(js,fjs);}}(document, 'script', 'twitter-wjs');
</script></a></div></section></article><section class="article-links"><ul class="pager"><li><a href="/articles/jeeves-an-open-source-webdriver/">Jeeves, an Open Source Webdriver &raquo;</a></li></ul></section><section class="article-comments"><div id="disqus_thread"></div>
<script type="text/javascript">
    var disqus_shortname = 'docusigndev';
    (function() {
        var dsq = document.createElement('script'); dsq.type = 'text/javascript'; dsq.async = true;
        dsq.src = '//' + disqus_shortname + '.disqus.com/embed.js';
        (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
    })();
</script>
<noscript>Please enable JavaScript to view the <a href="http://disqus.com/?ref_noscript">comments powered by Disqus.</a></noscript>
<a href="http://disqus.com" class="dsq-brlink">comments powered by <span class="logo-disqus">Disqus</span></a>
</section></main></div><footer class="row"></footer></div><script>var _gaq = _gaq || [];
_gaq.push(['_setAccount', 'UA-38381866-1']);
_gaq.push(['_trackPageview']);
(function() {
  var ga = document.createElement('script'); ga.type = 'text/javascript'; ga.async = true;
  ga.src = ('https:' == document.location.protocol ? 'https://ssl' : 'http://www') + '.google-analytics.com/ga.js';
  var s = document.getElementsByTagName('script')[0]; s.parentNode.insertBefore(ga, s);
})();</script></body></html>